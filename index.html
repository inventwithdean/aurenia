<!DOCTYPE html>
<!-- h-full results in 100vh height (viewport is the parent with definite height) -->
<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Study</title>
    <link rel="stylesheet" href="/src/minimal_pdf.css" />
    <link rel="stylesheet" href="/src/styles.css" />
    <script type="module" src="/src/study.js" defer></script>
    <script type="module" src="/src/library.js" defer></script>
    <script type="module" src="/src/theme.js" defer></script>
    <script type="module" src="/src/chat.js" defer></script>
  </head>
  <!-- By default, body is w-screen -->
  <body class="text-gray-100 h-full overflow-hidden">
    <!-- Library Page -->
    <div
      id="library-view"
      class="bg-gray-100 dark:bg-gray-800 flex flex-col h-full overflow-hidden"
    >
      <header class="bg-red-400 dark:bg-gray-900 py-2 px-3">
        <div class="flex justify-between">
          <span class="text-2xl font-bold text-gray-100">LibraryğŸ“”</span>
          <div class="flex items-center justify-center">
            <button
              class="text-xl theme-toggle-btn mr-4 text-gray-200 hover:text-white hover:scale-125 transition-transform duration-100 outline-0"
            >
              â˜€ï¸
            </button>
            <button
              class="ocr-toggle-btn py-1 px-2 mr-4 text-gray-200 hover:text-white hover:scale-125 transition-transform duration-100 rounded-2xl shadow-md outline-0"
            >
              OCR
            </button>
            <select
              id="language-select"
              class="mr-4 p-1 text-sm rounded-lg border border-red-400 dark:border-gray-700/50 bg-red-200 dark:bg-gray-800 text-gray-900 dark:text-gray-100 outline-0"
            >
              <option value="English">English</option>
              <option value="Mandarin Chinese">Mandarin Chinese</option>
              <option value="Hindi">Hindi</option>
              <option value="Spanish">Spanish</option>
              <option value="French">French</option>
              <option value="Standard Arabic">Standard Arabic</option>
              <option value="Bengali">Bengali</option>
              <option value="Russian">Russian</option>
              <option value="Portuguese">Portuguese</option>
              <option value="Urdu">Urdu</option>
              <option value="Indonesian">Indonesian</option>
              <option value="German">German</option>
              <option value="Japanese">Japanese</option>
              <option value="Nigerian Pidgin">Nigerian Pidgin</option>
              <option value="Egyptian Arabic">Egyptian Arabic</option>
              <option value="Marathi">Marathi</option>
              <option value="Telugu">Telugu</option>
              <option value="Turkish">Turkish</option>
              <option value="Tamil">Tamil</option>
              <option value="Cantonese">Cantonese</option>
              <option value="Vietnamese">Vietnamese</option>
              <option value="Wu Chinese">Wu Chinese</option>
              <option value="Tagalog">Tagalog</option>
              <option value="Korean">Korean</option>
              <option value="Farsi">Farsi</option>
            </select>
            <button id="upload-pdf-btn" class="text-gray-200 hover:text-white">
              <span> Add to Library </span>
            </button>
          </div>
        </div>
      </header>
      <!-- List PDFs with cover pages and titles. -->
      <div id="books-outer-container" class="flex-1 mx-auto overflow-auto">
        <div
          id="books-container"
          class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-y-4 gap-x-8 p-4 mx-auto"
        ></div>
      </div>
    </div>

    <!-- PDF Study Page -->
    <div id="pdf-study-view" class="hidden">
      <!-- By default, header is w-full -->
      <header class="bg-red-400 dark:bg-gray-900 shadow z-1000">
        <div class="flex items-center justify-between mx-auto px-4 py-3">
          <button
            id="back-to-library"
            class="text-gray-300 text-sm font-medium hover:text-gray-100"
          >
            Back to Library
          </button>
          <div class="flex items-center justify-center">
            <button
              class="theme-toggle-btn text-xl mr-4 text-gray-200 hover:text-white hover:scale-125 transition-transform duration-100 outline-0"
            >
              â˜€ï¸
            </button>
            <button
              class="ocr-toggle-btn py-1 px-2 mr-4 text-gray-200 hover:text-white hover:scale-125 transition-transform duration-100 rounded-2xl shadow-md"
            >
              OCR
            </button>
            <h2 id="pdf-title" class="text-sm font-semibold truncate">
              Loading PDF...
            </h2>
          </div>
        </div>
      </header>

      <div
        id="main-container"
        class="flex items-center justify-center bg-gray-100 dark:bg-gray-800 space-x-4"
      >
        <!-- PDF Container -->
        <div
          id="pdf-container"
          class="h-full max-w-3/5 w-1/2 flex flex-1 flex-col overflow-auto"
        ></div>
        <!-- Companion Container - MCQ, Chat etc. -->
        <div id="companion-container" class="hidden w-1/3 h-full p-4">
          <!-- MCQ Container -->
          <div
            id="mcq-container"
            class="companion-tab hidden bg-white dark:bg-gray-700/20 rounded-xl w-full h-full py-4 px-6 flex-col items-center text-gray-900 dark:text-white overflow-auto"
          >
            <span
              id="mcq-question"
              class="text-2xl text-center mb-12 font-semibold"
            >
              What is the capital of France?
            </span>
            <div id="mcq-options" class="grid gap-4 w-full max-w-md">
              <button
                id="mcq-option-a"
                class="bg-gray-200 dark:bg-gray-700 hover:bg-red-300 dark:hover:bg-gray-500 px-6 py-4 focus:ring-2 focus:ring-red-400 rounded-2xl transition-all shadow hover:shadow-lg text-left"
              >
                Berlin
              </button>
              <button
                id="mcq-option-b"
                class="bg-gray-200 dark:bg-gray-700 hover:bg-red-300 dark:hover:bg-gray-500 px-6 py-4 focus:ring-2 focus:ring-red-400 rounded-2xl transition-all shadow hover:shadow-lg text-left"
              >
                Paris
              </button>
              <button
                id="mcq-option-c"
                class="bg-gray-200 dark:bg-gray-700 hover:bg-red-300 dark:hover:bg-gray-500 px-6 py-4 focus:ring-2 focus:ring-red-400 rounded-2xl transition-all shadow hover:shadow-lg text-left"
              >
                Madrid
              </button>
              <button
                id="mcq-option-d"
                class="bg-gray-200 dark:bg-gray-700 hover:bg-red-300 dark:hover:bg-gray-500 px-6 py-4 focus:ring-2 focus:ring-red-400 rounded-2xl transition-all shadow hover:shadow-lg text-left"
              >
                Rome
              </button>
            </div>
            <button
              id="mcq-next-btn"
              class="mt-8 bg-red-400 dark:bg-gray-700 hover:bg-red-500 dark:hover:bg-gray-500 px-8 py-3 rounded-xl transition-all text-white font-bold shadow-md"
            >
              Next
            </button>
          </div>
          <!-- MCQ Results Container -->
          <div
            id="mcq-results-container"
            class="companion-tab hidden bg-white dark:bg-gray-700/20 rounded-xl w-full h-full p-4 flex-col items-center text-gray-900 dark:text-white overflow-auto"
          ></div>
          <!-- Summary Container -->
          <div
            id="summary-container"
            class="hidden companion-tab bg-white dark:bg-gray-700/20 rounded-xl w-full h-full py-4 pl-6 pr-1 flex-col text-gray-900 dark:text-white overflow-hidden"
          ></div>
          <div
            id="ai-results-container"
            class="hidden companion-tab bg-white dark:bg-gray-700/20 rounded-xl w-full h-full py-4 px-6 flex-col text-gray-900 dark:text-white overflow-hidden"
          ></div>
          <div
            id="companion-chat-container"
            class="companion-tab bg-white dark:bg-gray-700/20 rounded-xl w-full h-full py-4 pl-6 flex flex-col gap-y-4 text-gray-900 dark:text-white overflow-auto"
          >
            <!-- Will contain messages -->
            <!-- [scrollbar-width:thin] -->
            <div
              id="chat-messages"
              class="pr-6 flex-1 flex flex-col gap-y-4 overflow-auto scrollbar-thin scrollbar-thumb-gray-400 dark:scrollbar-thumb-gray-600 scrollbar-track-white dark:scrollbar-track-gray-700/20"
            ></div>
            <!-- Chat input and send buttons -->
            <div
              id="chat-controls"
              class="mr-6 flex flex-col bg-gray-200 dark:bg-gray-700 items-end gap-1.5 rounded-xl shadow-md"
            >
              <!-- Chat input -->
              <div
                class="flex-1 flex w-full flex-col min-h-14 max-h-[20dvh] px-2 pt-2 rounded-xl"
              >
                <div
                  id="chat-input-text"
                  contenteditable="true"
                  class="overflow-auto flex-1 [scrollbar-width:thin] outline-0"
                ></div>
              </div>
              <!-- Send Button -->
              <div class="w-full flex justify-between p-2">
                <button
                  id="pdf-context-btn"
                  class="text-xs font-medium rounded-full px-3 py-1 bg-gray-200 text-stone-600 dark:bg-gray-700 dark:text-stone-300 hover:bg-gray-50 dark:hover:bg-gray-500 transition-colors"
                >
                  PDF Context
                </button>
                <button
                  id="chat-send-btn"
                  class="rounded-2xl h-9 w-9 bg-white dark:bg-gray-500 flex items-center justify-center hover:cursor-pointer outline-0"
                >
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 20 20"
                    fill="currentColor"
                    xmlns="http://www.w3.org/2000/svg"
                    class="icon"
                  >
                    <path
                      d="M8.99992 16V6.41407L5.70696 9.70704C5.31643 10.0976 4.68342 10.0976 4.29289 9.70704C3.90237 9.31652 3.90237 8.6835 4.29289 8.29298L9.29289 3.29298L9.36907 3.22462C9.76184 2.90427 10.3408 2.92686 10.707 3.29298L15.707 8.29298L15.7753 8.36915C16.0957 8.76192 16.0731 9.34092 15.707 9.70704C15.3408 10.0732 14.7618 10.0958 14.3691 9.7754L14.2929 9.70704L10.9999 6.41407V16C10.9999 16.5523 10.5522 17 9.99992 17C9.44764 17 8.99992 16.5523 8.99992 16Z"
                    ></path>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- AI Popup Menu -->
      <div
        id="ai-menu"
        class="z-100 absolute shadow-xl bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-xl border border-gray-100 dark:border-gray-700 p-2 flex flex-col gap-2 items-start"
        style="visibility: hidden"
      >
        <button
          id="define-btn"
          class="w-full flex items-center gap-3 px-2 py-1 rounded-lg hover:bg-gray-300 dark:hover:bg-[#374151] hover:scale-[1.02] transform transition-transform duration-150"
        >
          ğŸ“– Define
        </button>
        <button
          id="translate-btn"
          class="w-full flex items-center gap-3 px-2 py-1 rounded-lg hover:bg-gray-300 dark:hover:bg-[#374151] hover:scale-[1.02] transform transition-transform duration-150"
        >
          ğŸŒ Translate
        </button>
        <button
          id="whatsthis-btn"
          class="w-full flex items-center gap-3 px-2 py-1 rounded-lg hover:bg-gray-300 dark:hover:bg-[#374151] hover:scale-[1.02] transform transition-transform duration-150"
        >
          ğŸ¤– What's this?
        </button>
      </div>
      <!-- Page Context Menu -->
      <div
        id="page-context-menu"
        class="z-100 absolute shadow-xl bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-xl border border-gray-200 dark:border-gray-700 p-2 flex flex-col gap-2 items-start"
        style="visibility: hidden"
      >
        <button
          id="generate-quiz-btn"
          class="w-full flex items-center gap-3 px-2 py-1 rounded-lg hover:bg-gray-300 dark:hover:bg-[#374151] hover:scale-[1.02] transform transition-transform duration-150"
        >
          ğŸ¤” Generate Quiz!
        </button>
        <button
          id="generate-summary-btn"
          class="w-full flex items-center gap-3 px-2 py-1 rounded-lg hover:bg-gray-300 dark:hover:bg-[#374151] hover:scale-[1.02] transform transition-transform duration-150"
        >
          ğŸ“” Summarize!
        </button>
      </div>

      <!-- Companion Button -->
      <button id="companion-button" class="text-2xl focus:outline-none">
        <span
          class="inline-block transition-all duration-100 transform hover:scale-125"
        >
          ğŸ”®
        </span>
      </button>
    </div>
  </body>
</html>
